<apex:page standardController="Account_Metric__c" extensions="AccountMetricExtension" cache="false">
     <style>
        
        
        div.header
        {
            background: -moz-linear-gradient(top, #1e5799 0%, #2989d8 50%, #207cca 51%, #7db9e8 100%);
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#1e5799), color-stop(50%,#2989d8), color-stop(51%,#207cca), color-stop(100%,#7db9e8));
            background: -webkit-linear-gradient(top, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%);
            background: -o-linear-gradient(top, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%);
            background: -ms-linear-gradient(top, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%);
            background: linear-gradient(to bottom, #336688 0%,#336688 50%,#336688 51%,#ffffff 100%);
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00ffffff', endColorstr='#bbffffff', GradientType=0 );
            box-shadow: inset 0px 10px 30px #336688;
        }
        
        div.blackdiv {
            position: absolute;
            top: -5px; 
            width: 3px; 
            /*left: 120px; */
            height: 30px; 
            float:left; 
            z-index:3; 
            background-color: black;
         }
           
        h1 {color:black; font-weight:bold; font-size:12px; text-align:center; position:relative; top:0px; left:3px;} <!-- Used -->
        h2 {color:black; font-weight:bold; font-size:12px; text-align:center; position:relative; top:0px;} <!-- Used -->
        h3 {color:blue; font-weight:normal; font-size:12px; text-align:center; position:relative; top:0px;} <!-- Used -->
        h4 {color:black; font-weight:bold; font-size:20px; position:relative; top:5px;} <!-- Used -->
        h5 {color:white; font-weight:bold; font-size:16px; position:relative; top:12px;} <!-- Used -->
        h6 {color:black; font-weight:bold; font-size:12px;}
        h7 {color:black; font-weight:normal; font-size:16px;}

    </style >    

<apex:form >

    <apex:pageBlock title=""> 
        <br/>            
        <apex:pageMessage summary="No Peer Groups." severity="info" strength="1" rendered="{!peerGroupPerAccountMetricList.size == 0}" />          
        <center>
        <!-- Top Title -->
        <table width="1200" border="0" cellspacing="0" cellpadding="0"><tr><td><h4>Account Health Scorecard</h4></td></tr></table>
        <br/><br/>
        
        <!-- Top Bar / Account Info -->
        <table width="1200" border="0" cellspacing="0" cellpadding="0">
        <tr><td>
            <div class="header" style="background-color:#336688; border: 1px solid black;border-top-left-radius:1em;border-top-right-radius:1em;height:40px;">
                <h5>&nbsp;&nbsp;&nbsp;Account Information</h5>
            </div>
            <div style="border: 1px solid black;">
                <br/>
                <!-- This section is new!!! -->
                <table border="0" width="100%">
                <!-- 1st Line -->
                <tr>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Account Name:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            {!accObj.Name}<apex:OutputText rendered="{!ISNULL(accObj.Name)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Graduation Date:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            <apex:outputText value="{0,date,MMMM dd, yyyy}">
                                    <apex:param value="{!accObj.Account_Graduation_Date_61_90__c}" />
                            </apex:outputText>               
                            <apex:OutputText rendered="{!ISNULL(accObj.Account_Graduation_Date_61_90__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Peer Group:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 1}" value="Fax"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 2}" value="Pro"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 3}" value="Pro1"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 4}" value="Office 2-9"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 9}" value="Office 10-19"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 5}" value="Office 20+ DLs"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 6}" value="ATT Premium Only"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 7}" value="ATT Virtual Only"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 8}" value="ATT Mix Users"/>
                            <apex:OutputText rendered="{!accountMetricObj.Peer_Group_ID__c == 101}" value="Other"/>
                            <apex:OutputText rendered="{!ISNULL(accountMetricObj.Peer_Group_ID__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                </tr>
                <!-- 2nd Line -->
                <tr>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Brand:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            {!accObj.RC_Brand__c }<apex:OutputText rendered="{!ISNULL(accObj.RC_Brand__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Contract:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">                            
                            <!-- check if start date is null, if not then there is no active sales agreement -->
                            <apex:OutputText rendered="{!quoteObj==null || ISNULL(quoteObj.Start_Date__c)}" value="No"/>                                                        
                            <apex:OutputText rendered="{quoteObj.Start_Date__c!=null && !today() >=quoteObj.Start_Date__c}" value="Yes"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Accounts in Peer Group:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            <apex:outputText value="{0,number,integer}">
                                <apex:param value="{!peergroupMap[1000].Number_of_Accounts__c}" />
                            </apex:outputText>                        
                            <apex:OutputText rendered="{!ISNULL(peergroupMap[1000].Number_of_Accounts__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                </tr>
                <!-- 3rd Line -->
                <tr>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Service:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            {!accObj.RC_Service_name__c }<apex:OutputText rendered="{!ISNULL(accObj.RC_Service_name__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Contract Renewal Date:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">                            
                            <apex:outputText value="{0,date,MMMM dd, yyyy}">
                                <apex:param value="{!quoteObj.End_Date__c+1 }" />
                            </apex:outputText>               
                            <apex:OutputText rendered="{!ISNULL(quoteObj.End_Date__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Account Age:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            <apex:outputText value="{0,number,integer}">
                                <apex:param value="{!accObj.Account_Age__c}" />
                            </apex:outputText>
                            <apex:OutputText rendered="{!ISNULL(accObj.Account_Age__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                </tr>
                <!-- 4th Line -->
                <tr>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Number of Lines:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            <apex:outputText value="{0,number,integer}">
                                <apex:param value="{!accObj.Number_of_DL_s__c}" />
                            </apex:outputText>
                            <apex:OutputText rendered="{!ISNULL(accObj.Number_of_DL_s__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Contract Term:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">                            
                            <apex:OutputText rendered="{!quoteObj==null || ISNULL(quoteObj.End_Date__c)}" value="N/A"/>
                            <apex:OutputText rendered="{!quoteObj.Start_Date__c != null && today() >=quoteObj.Start_Date__c && quoteObj.End_Date__c != null && today() <=quoteObj.End_Date__c}" value="{!quoteObj.Initial_Term_months__c}"/>
                            <apex:OutputText rendered="{!quoteObj.End_Date__c != null && today() >quoteObj.End_Date__c }" value="{!quoteObj.Term_months__c}"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>MRR:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            <apex:outputText value="{0,number,currency}">
                                <apex:param value="{!accObj.MRR__c}" />
                            </apex:outputText>
                            <apex:OutputText rendered="{!ISNULL(accObj.MRR__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                </tr>
                <!-- 5th Line -->
                <tr>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Number of Employees:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">
                            {!accObj.No_of_Employees__c}
                            <apex:OutputText rendered="{!ISNULL(accObj.No_of_Employees__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Auto renewal:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">                 
                            <apex:OutputText rendered="{!!quoteObj.Auto_Renewal__c == true}" value="Yes"/>
                            <apex:OutputText rendered="{!!quoteObj.Auto_Renewal__c == false}" value="No"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                    <td width="160"><h6>Expiration of CC:</h6></td>
                    <td width="200">
                        <div style="color:black; font-weight:normal; font-size:14px;">                  
                            <apex:outputText rendered="{!accObj.CCExpireDate__c != DATEVALUE('2050-12-31')}" value="{0,date,MMMM dd, yyyy}">
                                <apex:param value="{!accObj.CCExpireDate__c}" />
                            </apex:outputText>      
                            <apex:outputText rendered="{!accObj.CCExpireDate__c == DATEVALUE('2050-12-31')}" value="Invoiced">
                                <apex:param value="{!accObj.CCExpireDate__c}" />
                            </apex:outputText>            
                            <apex:OutputText rendered="{!ISNULL(accObj.CCExpireDate__c)}" value="N/A"/>
                        </div>
                    </td>
                    <td width="5">&nbsp;</td>
                </tr>                
                </table>
                <br/>
            </div>        
        </td></tr>
        </table>        
        <br/><br/>

        <table width="1200" border="0" cellspacing="0" cellpadding="0">
        <!-- Total -->
        <tr>
            <td width="390">&nbsp;</td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div class="header" style="background-color:#336688; border: 1px solid black;border-top-left-radius:1em;border-top-right-radius:1em;height:40px;">                    
                    <h5>Overall Score</h5>
                </div> 
            </td>
            <td width="10">&nbsp;</td>
            <td width="390">&nbsp;</td>
        </tr>
        <tr>
            <td width="390" align="center">
                &nbsp;
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div style="border:1px solid black; height:40px;border-bottom-left-radius:1em;border-bottom-right-radius:1em">
                    <table border="0">
                        <tr>                        
                        <td width="45"><center><h2><DIV style="position: relative; top: 8px;">Actual:<br/>{!Floor((accountMetricObj.Metric_1000_value__c)*100)}%</div></h2></center></td>
                        <td width="45"><center><h3><DIV style="position: relative; top: 8px;">Median:<br/>{!Floor((peergroupMap[1000].Median_Value__c)*100)}%</div></h3></center></td>
                        <td width="210">
                            <DIV style="position: relative; top: 0px; width: 3px; left: {!Floor((accountMetricObj.Metric_1000_Position__c)*2)}px; height: 30px; float:left; z-index:3; background-color: Black"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[1000].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[1000].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[1000].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                        </td>                                    
                        </tr>
                    </table>
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                &nbsp;
            </td>
        </tr>
        <!-- Filler -->
        <tr>
            <td width="390">&nbsp;</td>
            <td width="10">&nbsp;</td>
            <td width="390">&nbsp;</td>
            <td width="10">&nbsp;</td>
            <td width="390">&nbsp;</td>
        </tr>
        
        <!-- Breakdown -->
        <tr>
            <td width="390" align="center">
                <div class="header" style="background-color:#336688; border: 1px solid black;border-top-left-radius:1em;border-top-right-radius:1em;height:40px;">                    
                    <h5>Configuration Score</h5>
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div class="header" style="background-color:#336688; border: 1px solid black;border-top-left-radius:1em;border-top-right-radius:1em;height:40px;">                    
                    <h5>Usage Score</h5>
                </div> 
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div class="header" style="background-color:#336688; border: 1px solid black;border-top-left-radius:1em;border-top-right-radius:1em;height:40px;">
                    <h5>Health Score</h5>
                </div>
            </td>
        </tr>
        <!-- Header -->
        <tr>
            <td width="390" align="center">
                <div style="border:1px solid black; height:40px;">
                    <table border="0">
                        <tr>                        
                        <td width="45"><center><h2><DIV style="position: relative; top: 8px;">Actual:<br/>{!Floor((accountMetricObj.Metric_101_value__c)*100)}%</div></h2></center></td>
                        <td width="45"><center><h3><DIV style="position: relative; top: 8px;">Median:<br/>{!Floor((peergroupMap[101].Median_Value__c)*100)}%</div></h3></center></td>
                        <td width="210">
                            <DIV style="position: relative; top: 0px; width: 3px; left: {!Floor((accountMetricObj.Metric_101_Position__c)*2)}px; height: 30px; float:left; z-index:3; background-color: Black"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[101].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[101].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[101].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                        </td>                                    
                        </tr>
                    </table>
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div style="border:1px solid black; height:40px;">
                    <table border="0">
                        <tr>                        
                        <td width="45"><center><h2><DIV style="position: relative; top: 8px;">Actual:<br/>{!Floor((accountMetricObj.Metric_102_value__c)*100)}%</div></h2></center></td>
                        <td width="45"><center><h3><DIV style="position: relative; top: 8px;">Median:<br/>{!Floor((peergroupMap[102].Median_Value__c)*100)}%</div></h3></center></td>
                        <td width="210">
                            <DIV style="position: relative; top: 0px; width: 3px; left: {!Floor((accountMetricObj.Metric_102_Position__c)*2)}px; height: 30px; float:left; z-index:3; background-color: Black"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[102].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[102].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[102].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                        </td>                                    
                        </tr>
                    </table>
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div style="border:1px solid black; height:40px;">
                    <table border="0">
                        <tr>                        
                        <td width="45"><center><h2><DIV style="position: relative; top: 8px;">Actual:<br/>{!Floor((accountMetricObj.Metric_103_value__c)*100)}%</div></h2></center></td>
                        <td width="45"><center><h3><DIV style="position: relative; top: 8px;">Median:<br/>{!Floor((peergroupMap[103].Median_Value__c)*100)}%</div></h3></center></td>
                        <td width="210">
                            <DIV style="position: relative; top: 0px; width: 3px; left: {!Floor((accountMetricObj.Metric_103_Position__c)*2)}px; height: 30px; float:left; z-index:3; background-color: Black"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[103].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[103].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                            <DIV style="position: relative; top: 5px; width: {!floor(peergroupMap[103].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                        </td>                                    
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
        <!-- Header 2 -->
        <tr>
            <td width="390" align="center">
                <div style="border:1px solid black;background-color:#336688">
                    <table border="0">
                        <tr>
                        <td width="90"><center><h2><font color="#ffffff">Metric Name</font></h2></center></td>
                        <td width="45"><center><h2><font color="#ffffff">Actual</font></h2></center></td>
                        <td width="45"><center><h2><font color="#ffffff">Median</font></h2></center></td>
                        <td width="210"><center><h2><font color="#ffffff">Data Distribution</font></h2></center></td>                     
                        </tr>
                    </table>
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div style="border:1px solid black;background-color:#336688">
                    <table border="0">
                        <tr>
                        <td width="90"><center><h2><font color="#ffffff">Metric Name</font></h2></center></td>
                        <td width="45"><center><h2><font color="#ffffff">Actual</font></h2></center></td>
                        <td width="45"><center><h2><font color="#ffffff">Median</font></h2></center></td>
                        <td width="210"><center><h2><font color="#ffffff">Data Distribution</font></h2></center></td>                     
                        </tr>
                    </table>
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390" align="center">
                <div style="border:1px solid black;background-color:#336688">
                    <table border="0">
                        <tr>
                        <td width="90"><center><h2><font color="#ffffff">Metric Name</font></h2></center></td>
                        <td width="45"><center><h2><font color="#ffffff">Actual</font></h2></center></td>
                        <td width="45"><center><h2><font color="#ffffff">Median</font></h2></center></td>
                        <td width="210"><center><h2><font color="#ffffff">Data Distribution</font></h2></center></td>                     
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
        
        <!-- Border -->
        <tr>
            <td width="390">
                <div style="border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;">&nbsp;
                    <table border="0" valign="top" height="750">
                        <!-- Configuration-->
                        <!-- Line 1-->
                        <tr>
                            <td width="90">
                                <h1><span title="% of users having RC hardphones compared to total users. User type extension are used on on-UBP accounts. Devices not connected to any extension considered as assigned to ext 0. (4%)">
                                % of Users on Hard Phone
                                </span></h1>
                            </td>
                            <td width="45">
                               <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_1_value__c))}" value="{!Floor((accountMetricObj.Metric_1_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_1_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                               <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[1].Median_Value__c))}" value="{!Floor((peergroupMap[1].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[1].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_1_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_1_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[1].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[1].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[1].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[1].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[1].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[1].Green_Bucket_Label__c}
                                </div>                            
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 2-->
                        <tr>
                            <td width="90">
                                <h1><span title="% of Users with custom name. (1%)">
                                % of Users with Custom Name
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_9_value__c))}" value="{!Floor((accountMetricObj.Metric_9_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_9_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[9].Median_Value__c))}" value="{!Floor((peergroupMap[9].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[9].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_9_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_9_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[9].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[9].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[9].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[9].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[9].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[9].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 3-->
                        <tr>
                            <td width="90">
                                <h1><span title="Is the implementation completed? (6%)">
                                Implementation Completed
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_8_value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_8_value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_8_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!peergroupMap[8].Median_Value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!peergroupMap[8].Median_Value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[8].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_8_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_8_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[8].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                
                                <DIV style="position: relative; width: {!floor(peergroupMap[8].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[8].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[8].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 4-->
                        <tr>
                            <td width="90">
                                <h1><span title="Is personalized voicemails greeting set up? (1%)">
                                Customized Company Auto Receptionist
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_10_value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_10_value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_10_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!peergroupMap[10].Median_Value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!peergroupMap[10].Median_Value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[10].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_10_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_10_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[10].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                
                                <DIV style="position: relative; width: {!floor(peergroupMap[10].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[10].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[10].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 5-->
                        <tr>
                            <td width="90">
                                <h1><span title="Are answering rules configured? (1%)">
                                Customized company answering rules
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_12_value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_12_value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_12_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!peergroupMap[12].Median_Value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!peergroupMap[12].Median_Value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[12].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_12_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_12_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[12].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[12].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[12].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[12].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[12].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 6-->
                        <tr>
                            <td width="90">
                                <h1><span title="Number of departments configured. (1%)">
                                # of Configured Departments
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_13_value__c))}" value="{!Floor((accountMetricObj.Metric_13_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_13_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[13].Median_Value__c))}" value="{!Floor((peergroupMap[13].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[13].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_13_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_13_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[13].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[13].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[13].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[13].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[13].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[13].Green_Bucket_Label__c}
                                </div>    
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 7-->
                        <tr>
                            <td width="90">
                                <h1><span title="Is number listed in 411 directory? (1%)">
                                Published in 411 Directory
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_14_value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_14_value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_14_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!peergroupMap[14].Median_Value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!peergroupMap[14].Median_Value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[14].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_14_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_14_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[14].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[14].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[14].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[14].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 8-->
                        <tr>
                            <td width="90">
                                <h1><span title="Is BLF/Presence Configured? (1%)">
                                Configured Presence
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_15_value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!accountMetricObj.Metric_15_value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_15_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!peergroupMap[15].Median_Value__c == 0}" value="No"/>
                                <apex:OutputText rendered="{!peergroupMap[15].Median_Value__c == 1}" value="Yes"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[15].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_15_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_15_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[15].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>               
                                <DIV style="position: relative; width: {!floor(peergroupMap[15].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[15].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[15].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Extender-->
                        <tr height="100%">
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        
                    </table>            
                </div>
            </td>
            <td width="10">&nbsp;</td>
            <td width="390">
                <div style="border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;">&nbsp;
                    <table border="0" valign="top" height="750">
                        <!-- Usage -->
                        <!-- Line 1-->
                        <tr>
                            <td width="90">
                                <h1><span title="Usage from the last 60 days compared to the previous 60 days. Estimated from the calendar month totals. 100% means no change, 120% is 20% increase, 50% is drop in half. (10%)">
                                Minute Trend 60 over 60 (day over day)
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_3_value__c))}" value="{!Floor((accountMetricObj.Metric_3_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_3_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[3].Median_Value__c))}" value="{!Floor((peergroupMap[3].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[3].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_3_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_3_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[3].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[3].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[3].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[3].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[3].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[3].Green_Bucket_Label__c}
                                </div>                           
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 2-->
                        <tr>
                            <td width="90">
                                <h1><span title="Last 30 days connected time of all call types divided by the number of users. (5%)">
                                Average Minutes Used last 30 days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_2_value__c))}" value="{!Floor((accountMetricObj.Metric_2_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_2_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[2].Median_Value__c))}" value="{!Floor((peergroupMap[2].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[2].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_2_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_2_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[2].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[2].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[2].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[2].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[2].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[2].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 3-->
                        <tr>
                            <td width="90">
                                <h1><span title="Average of the last 60 days over previous 60 days prior year. (2%)">
                                Minute Trend 60 over 60 (year over year)
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_16_value__c))}" value="{!Floor((accountMetricObj.Metric_16_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_16_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[16].Median_Value__c))}" value="{!Floor((peergroupMap[16].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[16].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_16_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_16_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[16].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[16].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[16].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[16].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[16].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[16].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 4-->
                        <tr>
                            <td width="90">
                                <h1><span title="% of users active on any RC Mobile application in last 30 days. (1%)">
                                % of users using Mobile App (avg. last 30 days)
                                </span></h1>
                            </td>
                            <td width="45">
                              <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_18_value__c))}" value="{!Floor((accountMetricObj.Metric_18_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_18_value__c)}" value="N/A"/>
                                </h2></center>  
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[18].Median_Value__c))}" value="{!Floor((peergroupMap[18].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[18].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_18_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_18_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[18].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[18].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[18].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[18].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[18].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[18].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 5-->
                        <tr>
                            <td width="90">
                                <h1><span title="Addon Credits for the month. (1%)">
                                # of Calling Credits (Last 30 days)
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_5_value__c))}" value="${!Floor((accountMetricObj.Metric_5_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_5_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[5].Median_Value__c))}" value="${!Floor((peergroupMap[5].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[5].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_5_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_5_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[5].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[5].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[5].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[5].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[5].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[5].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 6-->
                        <tr>
                            <td width="90">
                                <h1><span title="# of Faxes sent / received successfully in the last 30 days per user. (2%)">
                                # of faxes sent (30 over 30 days)
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_17_value__c))}" value="{!Floor((accountMetricObj.Metric_17_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_17_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[17].Median_Value__c))}" value="{!Floor((peergroupMap[17].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[17].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_17_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_17_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[17].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[17].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[17].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[17].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[17].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[17].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 7-->
                        <tr>
                            <td width="90">
                                <h1><span title="% of faxes successfully transmitted in the last 30 days. (2%)">
                                % of faxes completed ( Last 30 days)
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_27_value__c))}" value="{!Floor((accountMetricObj.Metric_27_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_27_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[27].Median_Value__c))}" value="{!Floor((peergroupMap[27].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[27].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_27_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_27_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[27].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[27].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[27].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[27].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[27].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[27].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 8-->
                        <tr>
                            <td width="90">
                                <h1><span title="Number of Conference calls per user per month. (1%)">
                                Conference Calling Usage (30 over 30 Days)
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_20_value__c))}" value="{!Floor((accountMetricObj.Metric_20_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_20_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[20].Median_Value__c))}" value="{!Floor((peergroupMap[20].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[20].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_20_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_20_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[20].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[20].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[20].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[20].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[20].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[20].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Extender-->
                        <tr height="100%">
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        
                    </table>            
                </div>
            
            </td>
            <td width="10">&nbsp;</td>
            <td width="390">
                <div style="border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;">&nbsp;
                    <table border="0" valign="top" height="750">
                        <!-- Health -->
                        <!-- Line 1-->
                        <tr>
                            <td width="90">
                                <h1><span title="Number of Red account objects created in the past 180 days due to customer escalations. (10%)">
                                Red Account Created last 180 days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_28_value__c))}" value="{!Floor((accountMetricObj.Metric_28_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_28_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[28].Median_Value__c))}" value="{!Floor((peergroupMap[28].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[28].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_28_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_28_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[28].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[28].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[28].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[28].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[28].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[28].Green_Bucket_Label__c}
                                </div>                            
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 2-->
                        <tr>
                            <td width="90">
                                <h1><span title="# of support cases created in the last 30 days. (8%)">
                                # of Cases Created in the Last 30 Days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_24_value__c))}" value="{!Floor((accountMetricObj.Metric_24_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_24_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[24].Median_Value__c))}" value="{!Floor((peergroupMap[24].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[24].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_24_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_24_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[24].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[24].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[24].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[24].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[24].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[24].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 3-->
                        <tr>
                            <td width="90">
                                <h1><span title="">
                                Lowest CSAT - Last 60 days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <!-- Lowest CSAT - Last 60 days -->
                                <apex:OutputText rendered="{!objHealthScore.bLowestCSATNA}" value="{!Floor((objHealthScore.dLowestCSAT))}"/>
                                <apex:OutputText rendered="{!!objHealthScore.bLowestCSATNA}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                
                                </h3></center>
                            </td>
                            <td width="210">
                                <h1>Pending Next Release</h1>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 4-->
                        <tr>
                            <td width="90">
                                <h1><span title="# of PortOut requests in the last 30 days. (8%)">
                                Port-out in the Last 30 Days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_30_value__c))}" value="{!Floor((accountMetricObj.Metric_30_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_30_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[30].Median_Value__c))}" value="{!Floor((peergroupMap[30].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[30].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_30_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_30_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[30].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[30].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[30].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[30].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[30].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 5-->
                        <tr>
                            <td width="90">
                                <h1><span title="Number of lines 30 days ago vs as of today. (2%)">
                                % of DLs canceled in last 60 days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_4_value__c))}" value="{!Floor((accountMetricObj.Metric_4_value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_4_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[4].Median_Value__c))}" value="{!Floor((peergroupMap[4].Median_Value__c)*100)}%"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[4].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_4_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_4_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[4].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[4].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[4].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[4].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[4].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[4].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 6-->
                        <tr>
                            <td width="90">
                                <h1><span title="# of cases open for more than 30 days. (2%)">
                                Cases Open for 31+ days
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_29_value__c))}" value="{!Floor((accountMetricObj.Metric_29_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_29_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[29].Median_Value__c))}" value="{!Floor((peergroupMap[29].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[29].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_29_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_29_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[29].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[29].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[29].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[29].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[29].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[29].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 7-->
                        <tr>
                            <td width="90">
                                <h1><span title="Days to suspend because of a billing failure. N/A for active paid accounts. (2%)">
                                Days to Suspend
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                <apex:OutputText rendered="{!NOT(ISNULL(accountMetricObj.Metric_6_value__c))}" value="{!Floor((accountMetricObj.Metric_6_value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(accountMetricObj.Metric_6_value__c)}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                <apex:OutputText rendered="{!NOT(ISNULL(peergroupMap[6].Median_Value__c))}" value="{!Floor((peergroupMap[6].Median_Value__c))}"/>
                                <apex:OutputText rendered="{!ISNULL(peergroupMap[6].Median_Value__c)}" value="N/A"/>
                                </h3></center>
                            </td>
                            <td width="210">
                                <apex:outputPanel layout="block" style="position: relative;" rendered="{!NOT(ISNULL(accountMetricObj.Metric_6_Position__c))}">
                                    <DIV class="blackdiv" style="left: {!Floor(accountMetricObj.Metric_6_Position__c)*2}px"></div>
                                </apex:outputPanel>
                                <DIV style="position: relative; width: {!floor(peergroupMap[6].Red_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Red"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[6].Yellow_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Yellow"></DIV>
                                <DIV style="position: relative; width: {!floor(peergroupMap[6].Green_Bucket_Percentage__c*200)}px; height: 25px; float:left; background-color: Green"></DIV>                                                                     
                                <br/><br/>
                                <DIV style="position: relative; width: 200px; height: 25px; float:left; color:black; float:left; font-weight:bold; font-size:10px; z-index:4; text-align:center">                            
                                R:{!peergroupMap[6].Red_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;Y:{!peergroupMap[6].Yellow_Bucket_Label__c}&nbsp;&nbsp;&nbsp;&nbsp;G:{!peergroupMap[6].Green_Bucket_Label__c}
                                </div>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 8-->
                        <tr>
                            <td width="90">
                                <h1><span title="">
                                New Customer Survey
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                 <!-- New Customer Survey Value -->
                                <apex:OutputText rendered="{!objHealthScore.bNewCustomerNA}" value="{0, number,#0.0}"><apex:param value="{!objHealthScore.dNewCustomer}" /></apex:OutputText>
                                <apex:OutputText rendered="{!!objHealthScore.bNewCustomerNA}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                
                                </h3></center>
                            </td>
                            <td width="210">
                                <h1>Pending Next Release</h1>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 9-->
                        <tr>
                            <td width="90">
                                <h1><span title="">
                                Relationship Survey
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                 <!-- Relationship Survey Value -->
                                 <apex:OutputText rendered="{!objHealthScore.bRelationshipNA}" value="{0, number,#0.0}"><apex:param value="{!objHealthScore.dRelationship}" /></apex:OutputText>
                                <apex:OutputText rendered="{!!objHealthScore.bRelationshipNA}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                
                                </h3></center>
                            </td>
                            <td width="210">
                                <h1>Pending Next Release</h1>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 9-->
                        <tr>
                            <td width="90">
                                <h1><span title="">
                                Support Survey
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                 <!-- Support Survey Avg Value -->
                                 <apex:OutputText rendered="{!objHealthScore.bSupportNA}" value="{0, number,#0.0}"><apex:param value="{!objHealthScore.dSupport}" /></apex:OutputText>
                                <apex:OutputText rendered="{!!objHealthScore.bSupportNA}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                
                                </h3></center>
                            </td>
                            <td width="210">
                                <h1>Pending Next Release</h1>
                            </td>
                        </tr>
                        <!-- Filler-->
                        <tr>
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        <!-- Line 9-->
                        <tr>
                            <td width="90">
                                <h1><span title="">
                                Implementation Survey
                                </span></h1>
                            </td>
                            <td width="45">
                                <center><h2>
                                 <!-- Implementation Survey Value -->
                                <apex:OutputText rendered="{!objHealthScore.bImplementationNA}" value="{0, number,#0.0}"><apex:param value="{!objHealthScore.dImplementation}" /></apex:OutputText>
                                <apex:OutputText rendered="{!!objHealthScore.bImplementationNA}" value="N/A"/>
                                </h2></center>
                            </td>
                            <td width="45">
                                <center><h3>
                                
                                </h3></center>
                            </td>
                            <td width="210">
                                <h1>Pending Next Release</h1>
                            </td>
                        </tr>
                        
                        
                        <!-- Extender-->
                        <tr height="100%">
                            <td width="90">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="45">&nbsp;</td>
                            <td width="210">&nbsp;</td>
                        </tr>
                        
                    </table>            
                </div>
                
            </td>
        </tr>
        
        
        
        </table>
        
        </center>
        <Br/>
     
        <!-- Disable buttons
        <div  class="btnDivNew" >
            <input type="button" class="btn" value="Show/Hide Metrics" onClick="showHide('xDetails');return false;" />
            <input type="button" class="btn" value="Export as PDF" onClick="window.open('/apex/AccountHealthSummaryPDF?accid={!accObj.id}');" />&nbsp;
            <input type="button" class="btn" value="Send Email" onClick="sendMailToCustomer();return false;" />
        </div>
        -->
        
        </apex:pageBlock>
        
        
        <apex:ActionFunction action="{!redirectToSendMailPage}" name="sendMailToCustomer"></apex:ActionFunction>
    

</apex:form>

        
        
    <script>
        function showHide(divId) {
            var divObj = document.getElementById(divId);
            divObj.style.display=( divObj.style.display=="block"?"none":"block");
        }    
        function sendMail() {
            var emailId = '{!emailaddress}';
            //alert(emailId);
            var confirmChk = confirm("Are you sure you want to send mail to "+emailId);
            //alert(confirmChk);
            if(confirmChk) {
                sendMailToCustomer();
            }
        }
        
        function mailsent() {
            if('{!isMailSent}') {
                alert('Mail Sent');
            } else {
                alert('Error Occured.');
            }
            
        }
    </script>    
    
</apex:page>